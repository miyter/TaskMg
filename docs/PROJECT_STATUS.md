# TaskMg プロジェクト状況ドキュメント

**最終更新**: 2025-12-30

## 📝 プロダクト概要
**TaskMg** は、目標達成とタスク管理を統合した先進的な Web アプリケーションです。
**「目標（Target）から逆算して、日々の行動（Task）を設計する」** というコンセプトの元、単なるToDoリストではなく、OKR、WOOP、バックワード・デザインといった複数のフレームワークをシームレスに切り替えて利用できることが特徴です。

### 主な機能
- **高度なタスク管理**: プロジェクト、ラベル、時間帯（Time Block）、所要時間による多角的なフィルタリングと統計表示。
- **目標設計ウィザード**: 対話形式で目標を明確化し、行動計画へと落とし込むガイド機能。
- **マルチフレームワーク**: OKR、WOOP、バックワード・デザインなど、状況に応じた目標管理手法をサポート。
- **フレームワーク Wiki**: 各手法のベストプラクティスをアプリ内で学習・参照可能。

---

## 🏗️ 技術スタック

| カテゴリ | 技術 | バージョン |
|----------|------|------------|
| **フレームワーク** | React | 18.3.1 |
| **ビルドツール** | Vite | 6.0.0 |
| **言語** | TypeScript | 5.9.3 |
| **状態管理** | Zustand | 5.0.9 |
| **スタイリング** | Tailwind CSS | 3.4.3 |
| **バックエンド** | Firebase Firestore | 10.14.1 |
| **D&D** | @dnd-kit | 6.3.1 |

---

## 📁 ディレクトリ構造

```
src/
├── App.tsx              # React アプリケーションルート
├── main.tsx             # エントリーポイント
│
├── components/          # 共有・UIコンポーネント
│   ├── auth/            # 認証関連 (LoginPage)
│   ├── layout/          # レイアウト (AppLayout)
│   ├── modals/          # モーダル管理
│   ├── sidebar/         # サイドバー構成要素
│   └── tasks/           # タスクリスト・アイテム
│
├── features/            # 機能モジュール
│   ├── target-dashboard/ # 目標ダッシュボード (OKR/WOOP/Backward)
│   ├── wiki/            # フレームワーク解説Wiki
│   └── wizard/          # 目標設計ウィザード
│
├── hooks/               # カスタムフック (useTasks, useProjects...)
├── store/               # Zustand & Firestore Logic
├── core/                # Firebase設定・定数
├── logic/               # ビジネスロジック (検索・ソート等)
└── utils/               # ユーティリティ関数
```

---

## 🔄 現在のステータス

### リファクタリング完了 (2025-12-30) ✅
- **完全 React 化**: `src/ui` 内のレガシー DOM 操作コードを全廃し、全て React コンポーネントに移行完了。
- **ディレクトリ最適化**: `src/features` に主要機能をフラットに配置し、見通しを改善。
- **型安全性**: プロジェクト全体の TypeScript 化率 100%。

### パフォーマンス/設計改善 (2025-12-30) ✅
- **データ購読の高度化**: `store-raw.ts` / `projects-raw.ts` にて、JSON比較による更新抑制と参照安定化を実装。
- **レンダリング最適化**: `TaskItem`, `ProjectItem` の `React.memo` 化および `CustomFilterList` の `useMemo` による計算コスト削減。
- **App.tsx スリム化**: サイドバー定義とDnDロジックを分離 (`SidebarContent`, `useAppDnD`)。
- **コード共通化**: 日付処理 (`utils/date.ts`) と UI密度ロジック (`utils/ui-utils.ts`) を集約し、各コンポーネントで再利用開始。
- **設定の永続化**: ソート・完了表示設定を `filter-store` に統合し永続化。`TaskList` にUI追加。

### 残務処理・品質向上 (2025-12-30) ✅
- **未使用コード削除**: `api-adapters.ts`, レガシー `showMessageModal` 依存関係、未使用 `getTasks()` 関数を削除。
- **破損したインポートパスの修正**: `features/` 配下の壊れた相対パスを多数修正。
- **TypeScript 型チェック 100% pass**: `npx tsc --noEmit` がエラーなしで完了。

### 健全性
💎 **極めて良好**
技術的負債の大半（レガシーバックエンドロジック、DOM直接操作）が解消され、新機能開発やパフォーマンスチューニングに適したクリーンな状態です。

---

## 🎯 次のステップ

1. **パフォーマンス最適化 (残課題)**
   - **仮想スクロール**: TaskList のタスク数増大に備え、`react-window` 等の導入を検討（必要に応じて）。

2. **品質向上**
   - テストカバレッジの拡充 (現状0%)。

3. **新機能開発への復帰**
   - 既存機能のブラッシュアップや、ユーザーフィードバックに基づく新機能追加。

---

## 🔧 開発コマンド

```bash
# 開発サーバー
npm run dev

# 型チェック
npx tsc --noEmit

# ビルド
npm run build
```
