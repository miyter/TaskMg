カスタムフィルター機能仕様書

Todoistの強力なフィルター機能を再現するための設計ドキュメントです。

1. フィルター作成UIモック

テキストベースのモーダルUIイメージです。

+-------------------------------------------------------+
|  フィルターを作成                                     |
+-------------------------------------------------------+
|  フィルター名                                         |
|  [ 今日のタスク & パソコン                           ]|
|                                                       |
|  クエリ                                               |
|  [ (今日 | 明日) & @パソコン & !#プライベート        ]|
|                                                       |
|  カラー                                               |
|  (● 赤)  (○ 青)  (○ 緑)  ...                          |
|                                                       |
|  お気に入りに追加 [v]                                 |
+-------------------------------------------------------+
|           [ キャンセル ]   [   追 加   ]              |
+-------------------------------------------------------+


2. クエリ検索文法一覧

Todoistの文法に準拠し、記号とキーワードの両方をサポートします。

項目

記号 / キーワード

例

説明

論理演算子

&

今日 & p1

両方の条件を満たす (AND)



`

`

`今日



!

!@待機

条件を満たさない (NOT)



()

`(今日

明日) & p1`

日付

今日, today

今日

期限が今日



明日, tomorrow

明日

期限が明日



昨日, yesterday

昨日

期限が昨日



期限切れ, overdue

期限切れ

今日より前



期限なし, no date

期限なし

期限設定なし



次のx日間

次の7日間

今日からx日間



yyyy/mm/dd

2023/12/31

特定の日付

プロジェクト

#

#仕事

プロジェクト名部分一致





#仕事 & #会議

プロジェクトの交差は通常空だが検索としては有効

ラベル

@

@メール

ラベル名部分一致



ラベルなし

!@ラベルなし

ラベルが付いているもの

優先度

p1, p2, p3, p4

p1

優先度 (p1=高, p4=低)

キーワード

(そのまま入力)

会議

タスク名または説明に「会議」を含む

3. 実装アプローチ

Tokenizer: クエリ文字列をトークン列（演算子、キーワード、リテラル）に分解。

Parser: トークン列を構文解析し、AST（抽象構文木）または逆ポーランド記法に変換。

Evaluator: タスクオブジェクトを受け取り、ASTに基づいて true/false を返す関数を生成。

※ src/logic/filter-parser.js にこの完全なロジックを実装済みです。