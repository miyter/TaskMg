import{r as t,R as O,j as s}from"./react-vendor-BXbslbVD.js";import{u as R,a as S,b as M,U as k,c as D,d as I,e as T,I as A,C as B,f as F,B as g,g as U}from"./main-CyU-t20e.js";import{E as q}from"./ErrorMessage-0p6ogyRZ.js";import{M as z}from"./Modal-BBAthaC7.js";import"./vendor-2KhDdVeI.js";import"./dnd-zsmWqcr7.js";import"./firebase-Cd0JjRge.js";import"./i18n-D6HtkF0c.js";import"./date-fns-C4HQ7vGy.js";const X=({isOpen:j,data:_,zIndex:C,overlayClassName:E})=>{const{t:r}=R(),{closeModal:l,openModal:x}=S(),p=!!j,e=_,c=!!(e!=null&&e.id),{workspaceId:o}=M(),[m,b]=t.useState(""),[n,v]=t.useState(k.DEFAULT_COLORS.LABEL),[u,i]=t.useState(!1),[f,d]=t.useState(null),h=O.useRef(null);t.useEffect(()=>{p&&(b((e==null?void 0:e.name)||""),v((e==null?void 0:e.color)||k.DEFAULT_COLORS.LABEL),d(null),i(!1))},[p,e]),t.useEffect(()=>{var a;f&&((a=h.current)==null||a.focus())},[f]);const y=t.useCallback(async()=>{const a=m.trim();if(!a){d(r("validation.label_name_required"));return}i(!0),d(null);try{if(!o){d(r("validation.label_workspace_required")),i(!1);return}c&&(e!=null&&e.id)?await D(o,e.id,{name:a,color:n}):await I(o,a,n),l()}catch(w){d(r("validation.save_fail")+": "+(w.message||"Error")),i(!1)}},[m,n,c,e,l,r]),N=t.useCallback(async()=>{e!=null&&e.id&&x("confirmation",{title:r("delete"),message:r("modal.label_delete_confirm").replace("{name}",e.name),confirmLabel:r("delete"),variant:"danger",onConfirm:async()=>{i(!0);try{o&&(e!=null&&e.id)&&await T(o,e.id),l()}catch{d(r("validation.delete_fail")),i(!1)}}})},[e,l,x,o,r]),L=a=>{a.key==="Enter"&&!a.nativeEvent.isComposing&&(!u&&m.trim()&&y(),a.preventDefault())};return p?s.jsx(z,{isOpen:p,onClose:l,className:"max-w-sm",zIndex:C,overlayClassName:E,children:s.jsxs("div",{className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex-shrink-0 border-2 border-gray-100 dark:border-gray-700 shadow-sm",style:{backgroundColor:n}}),s.jsx("div",{className:"flex-1",children:s.jsx(A,{ref:h,id:"label-name-input",name:"labelName",type:"text",label:r("modal.label_name"),value:m,onChange:a=>b(a.target.value),onKeyDown:L,placeholder:r(c?"modal.label_name_placeholder":"modal.label_create_placeholder"),className:"bg-transparent border-none text-lg font-bold p-0 focus:ring-0 focus:border-transparent px-0 py-0 rounded-none h-auto",containerClassName:"gap-0",autoFocus:!0,"aria-invalid":!!f,"aria-describedby":f?"label-error-msg":void 0})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-2",children:r("modal.theme_color")}),s.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(a=>s.jsx("button",{type:"button",onClick:()=>v(a.value),className:F("w-6 h-6 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",n===a.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-gray-800":""),style:{backgroundColor:a.value},"aria-label":r(`colors.${a.key}`),"aria-pressed":n===a.value},a.value))})]}),s.jsx(q,{message:f}),s.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"flex items-center gap-2",children:c&&s.jsx(g,{onClick:N,disabled:u,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20","aria-label":r("modal.delete_label"),title:r("modal.delete_label"),children:s.jsx(U,{size:20})})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(g,{onClick:l,disabled:u,variant:"ghost",children:r("modal.cancel")}),s.jsx(g,{onClick:y,disabled:u||!m.trim(),isLoading:u,variant:"primary",children:r(c?"modal.save":"modal.create")})]})]})]})}):null};export{X as LabelEditModal};
