import{c as m,j as e,d as p}from"./vendor-j1jwJuCp.js";import{al as w,u as b,B as j,am as k,K as v}from"./main-DbJl66SC.js";import{s as N,g as _,i as C}from"./targets-7qOygvo4.js";import"./firebase-CTDNBn9D.js";import"./i18n-DVG6a50L.js";const $=()=>{const{entities:a,loading:d}=w({entityName:"targets",subscribeFn:(t,s)=>N(t,s),getCacheFn:_,isInitializedFn:C});return{targets:a,loading:d}},T=m.memo(({kgi:a,currentTab:d,onTabChange:t,collapsed:s,onToggleCollapse:i})=>{const{t:l}=b(),g={good:"text-emerald-500",warning:"text-amber-500",danger:"text-red-500"},c={good:"bg-emerald-500",warning:"bg-amber-500",danger:"bg-red-500"},o=g[a.status]||"text-gray-500",h=c[a.status]||"bg-gray-500",u=[{id:"backward",label:l("backward_map"),icon:"ðŸ—ºï¸"},{id:"woop",label:l("woop_board"),icon:"âœ¨"},{id:"okr",label:l("okr_tree"),icon:"ðŸŽ¯"}];return e.jsx("div",{className:`mb-6 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-2xl border border-gray-200 dark:border-gray-700 shadow-lg transition-all duration-300 mx-4 mt-4 ${s?"py-2":"py-4"}`,children:e.jsxs("div",{className:"px-6 flex items-center justify-between gap-6",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h1",{className:`font-bold text-gray-900 dark:text-white truncate transition-all duration-300 ${s?"text-sm opacity-50":"text-base"}`,children:a.title})}),e.jsx("div",{className:"flex-1 max-w-md hidden sm:block",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"h-3 overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700",children:e.jsx("div",{style:{width:`${a.progress}%`},className:`h-full ${h} transition-all duration-1000 ease-out rounded-full`})})}),e.jsxs("span",{className:`font-black ${o} tabular-nums text-sm whitespace-nowrap`,children:[a.progress,"%"]})]})}),e.jsxs("div",{className:"flex items-center gap-6 flex-shrink-0",children:[e.jsxs("div",{className:"text-center hidden sm:block",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:l("target_dashboard.days_left")}),e.jsxs("div",{className:`font-black ${o} tabular-nums`,children:[a.daysLeft,e.jsx("span",{className:"text-xs font-medium ml-0.5 text-gray-400",children:l("target_dashboard.days_unit")})]})]}),e.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-900/50 p-1 rounded-lg",children:u.map(n=>e.jsxs("button",{onClick:()=>t(n.id),className:`group px-3 py-1.5 rounded-md text-xs font-bold transition-all flex flex-col sm:flex-row items-center gap-1 sm:gap-2 ${d===n.id?"bg-white dark:bg-gray-700 shadow-sm text-gray-900 dark:text-white":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}`,title:n.label,children:[e.jsx("span",{className:"text-sm sm:text-base leading-none",children:n.icon}),e.jsx("span",{className:"text-[10px] sm:text-xs leading-none",children:n.label})]},n.id))}),e.jsx(j,{variant:"ghost",size:"icon",onClick:i,title:l(s?"target_dashboard.header_expand":"target_dashboard.header_collapse"),className:"rounded-lg",children:e.jsx(k,{className:`w-4 h-4 text-gray-500 transition-transform duration-300 ${s?"rotate-180":""}`})})]})]})})}),z=m.memo(({data:a})=>{const{t:d}=b();return!a||!a.milestones?e.jsx("div",{className:"p-4 text-center text-gray-500",children:d("target_dashboard.loading_error")}):e.jsxs("div",{className:"max-w-4xl mx-auto relative pb-10",children:[e.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700 -translate-x-1/2"}),a.milestones.map((t,s)=>{const i=t.type==="goal",l=t.type==="current",g=t.completed;let c,o="";return i?(c=e.jsx("div",{className:"w-8 h-8 rounded-full bg-yellow-400 text-white flex items-center justify-center text-base shadow-md ring-4 ring-gray-50 dark:ring-gray-900 z-10 relative",children:"ðŸ†"}),o="bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700"):l?(c=e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold shadow-md ring-4 ring-gray-50 dark:ring-gray-900 z-10 animate-pulse relative",children:d("target_dashboard.backward.now_icon")}),o="border-blue-500 border-2 shadow-md"):g?(c=e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center text-xs shadow ring-4 ring-gray-50 dark:ring-gray-900 z-10 relative",children:"âœ“"}),o="bg-gray-50 dark:bg-gray-800 opacity-70"):(c=e.jsx("div",{className:"w-5 h-5 rounded-full bg-white dark:bg-gray-700 border-2 border-gray-300 dark:border-gray-500 ring-4 ring-gray-50 dark:ring-gray-900 z-10 relative"}),o="bg-white dark:bg-gray-800"),e.jsxs("div",{className:"relative flex items-center mb-4 animate-fade-in group",style:{animationDelay:`${s*50}ms`},children:[e.jsx("div",{className:"w-16 flex-shrink-0 flex justify-center items-center z-10",children:c}),e.jsx("div",{className:"flex-1 pr-4 min-w-0",children:e.jsx("div",{className:`px-3 py-3 rounded-lg border ${l&&!o.includes("border-2")?"border-2 border-blue-500":l?"":"border-gray-200 dark:border-gray-700"} ${o} shadow-sm transition-all hover:shadow-md hover:translate-x-1 cursor-pointer`,children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:`text-xs font-bold ${l?"text-blue-600":"text-gray-500"} flex-shrink-0 font-mono`,children:t.date}),e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white flex-1 truncate text-sm md:text-base",children:t.title}),i&&e.jsx("span",{className:"text-[10px] bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full font-bold flex-shrink-0",children:d("target_dashboard.backward.target_label")}),l&&e.jsx("span",{className:"text-[10px] text-blue-500 font-bold flex-shrink-0",children:d("target_dashboard.backward.now_label")})]})})})]},t.id||`milestone-${s}`)})]})}),D=m.memo(({data:a})=>{const{t:d}=b();if(!a||!a.keyResults)return e.jsx("div",{className:"p-4 text-center text-gray-500",children:d("target_dashboard.loading_error")});const t=s=>s==="high"?"bg-emerald-500":s==="medium"?"bg-amber-500":"bg-red-500";return e.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-2xl border-2 border-blue-100 dark:border-blue-900 shadow-lg text-center mb-12 relative z-10 transition-transform hover:scale-[1.01]",children:[e.jsx("div",{className:"absolute top-[-15px] left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-md",children:d("target_dashboard.okr.objective_label")}),e.jsxs("h2",{className:"font-black text-2xl md:text-3xl text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 leading-tight",children:['"',a.objective,'"']}),e.jsx("div",{className:"absolute bottom-[-50px] left-1/2 w-1 h-[50px] bg-gray-200 dark:bg-gray-700 z-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative",children:[e.jsx("div",{className:"hidden md:block absolute top-[-25px] left-[16.66%] right-[16.66%] h-1 bg-gray-200 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-700 rounded-t-xl z-0"}),a.keyResults.map(s=>{const i=s.target>0?Math.round(s.current/s.target*100):0,l=t(s.confidence);return e.jsxs("div",{className:"relative pt-6",children:[e.jsx("div",{className:"absolute top-[-25px] left-1/2 w-1 h-[25px] bg-gray-200 dark:bg-gray-700 md:block hidden"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-lg hover:border-blue-300 dark:hover:border-blue-700 transition-all group h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-400",children:[d("target_dashboard.okr.kr_prefix"),s.id]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${l}`,title:`Confidence: ${s.confidence}`})]}),e.jsx("h4",{className:"font-bold text-gray-800 dark:text-gray-200 mb-4 h-12 line-clamp-2",children:s.text}),e.jsxs("div",{className:"space-y-1 mt-auto",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:s.current}),e.jsx("span",{children:s.target})]}),e.jsx("div",{className:"h-2 w-full bg-gray-100 dark:bg-gray-900 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-1000",style:{width:`${i}%`}})}),e.jsxs("div",{className:"text-right text-sm font-black text-blue-600 mt-1",children:[i,"%"]})]})]})]},s.id)})]})]})}),L=m.memo(({data:a})=>{const{t:d}=b();return!a||!a.obstacles?e.jsx("div",{className:"p-4 text-center text-gray-500",children:d("target_dashboard.loading_error")}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto animate-fade-in",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-900/30 dark:to-blue-900/30 p-6 rounded-2xl border border-indigo-100 dark:border-indigo-800 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"text-sm font-bold text-indigo-500 uppercase mb-2",children:d("target_dashboard.woop.wish_label")}),e.jsxs("p",{className:"font-bold text-gray-900 dark:text-white leading-relaxed text-lg",children:['"',a.wish,'"']})]}),e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-900/30 dark:to-rose-900/30 p-6 rounded-2xl border border-pink-100 dark:border-pink-800 shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("h3",{className:"text-sm font-bold text-pink-500 uppercase mb-2",children:d("target_dashboard.woop.outcome_label")}),e.jsxs("p",{className:"font-bold text-gray-900 dark:text-white leading-relaxed text-lg",children:['"',a.outcome,'"']})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-500 uppercase mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸš§"})," ",d("target_dashboard.woop.obstacles_header")]}),a.obstacles.map(t=>e.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all overflow-hidden relative",children:[e.jsx("div",{className:"p-5 border-l-4 border-gray-400 bg-gray-50 dark:bg-gray-800 relative z-10 transition-transform group-hover:translate-x-1",children:e.jsxs("h4",{className:"font-bold text-gray-700 dark:text-gray-300 flex items-center",children:[e.jsx("span",{className:"bg-gray-200 dark:bg-gray-700 text-xs px-2 py-1 rounded mr-3 text-gray-600 dark:text-gray-400",children:d("target_dashboard.woop.obstacle_badge")}),t.text]})}),e.jsxs("div",{className:"p-4 bg-emerald-50 dark:bg-emerald-900/20 border-t border-gray-100 dark:border-gray-700 flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("span",{className:"block w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-xs font-bold",children:d("target_dashboard.woop.if_badge")})}),e.jsx("div",{className:"ml-3 flex-1",children:e.jsxs("p",{className:"text-emerald-800 dark:text-emerald-300 font-bold text-sm",children:["â†’ ",t.plan]})}),e.jsxs("div",{className:"ml-2 flex flex-col items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:d("target_dashboard.woop.score_label")}),e.jsx("span",{className:"text-lg font-black text-emerald-500 leading-none",children:t.overcomeCount})]})]})]},t.id)),e.jsx("button",{className:"w-full py-3 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl text-gray-400 hover:border-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition flex items-center justify-center font-bold text-sm",children:d("target_dashboard.woop.add_obstacle")})]})]})}),U=()=>{var f;const{t:a}=b(),{targets:d}=$(),[t,s]=p.useState("backward"),[i,l]=p.useState(!1),g=d.filter(r=>{var x;return((x=r.mode)==null?void 0:x.toLowerCase())===t.toLowerCase()}),c=r=>({milestones:[{date:a("target_dashboard.backward.timeline.future"),title:r.data.goal_kgi||a("target_dashboard.kgi_default"),type:"goal",completed:!1},{date:a("target_dashboard.backward.timeline.milestone"),title:r.data.milestone_minus_1mo||"",type:"milestone",completed:!1},{date:a("target_dashboard.backward.timeline.today"),title:a("target_dashboard.backward.current_status"),type:"current",completed:!0},{date:a("target_dashboard.backward.timeline.now"),title:r.data.first_action||"",type:"action",completed:!1}]}),o=r=>({wish:r.data.wish||"",outcome:r.data.outcome||"",obstacles:[{id:1,text:r.data.obstacle||"",plan:r.data.plan||"",overcomeCount:0}]}),h=r=>({objective:r.data.objective||"",keyResults:[{id:1,text:r.data.kr_1||`${a("target_dashboard.okr.kr_prefix")}1`,current:0,target:100,confidence:"medium"},{id:2,text:r.data.kr_2||`${a("target_dashboard.okr.kr_prefix")}2`,current:0,target:100,confidence:"medium"},{id:3,text:r.data.kr_3||`${a("target_dashboard.okr.kr_prefix")}3`,current:0,target:100,confidence:"medium"}]}),u=()=>g.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 dark:text-gray-400",children:e.jsx("p",{className:"mb-4",children:a("target_dashboard.no_targets",{mode:t.toUpperCase()})})}):e.jsx("div",{className:"space-y-12",children:g.map(r=>{var x;return e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-12 last:border-0",children:[e.jsx("div",{className:"mb-4 text-xs text-gray-400 flex justify-end",children:a("target_dashboard.created_at",{date:((x=v(r.createdAt))==null?void 0:x.toLocaleDateString())||"Unknown"})}),t==="backward"&&e.jsx(z,{data:c(r)}),t==="woop"&&e.jsx(L,{data:o(r)}),t==="okr"&&e.jsx(D,{data:h(r)})]},r.id)})}),n=g[0],y={title:((r,x)=>r?x==="backward"?r.data.goal_kgi||a("target_dashboard.kgi_default"):x==="woop"?r.data.wish||a("target_dashboard.wish_default"):x==="okr"?r.data.objective||a("target_dashboard.obj_default"):a("target_dashboard.target_default"):a("target_dashboard.title_default"))(n,t),progress:Number(((f=n==null?void 0:n.data)==null?void 0:f.progress)||0),daysLeft:0,status:"good"};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50 dark:bg-gray-900 overflow-hidden",children:[e.jsx(T,{kgi:y,currentTab:t,onTabChange:s,collapsed:i,onToggleCollapse:()=>l(!i)}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-6 pb-6 pt-4",children:u()})]})};export{U as DashboardApp};
