import{r as t,R as M,j as s}from"./react-vendor-D2I7O6xs.js";import{u as R,a as S,d as D,C as p,g as I,h as O,i as T,I as q,j as z,B as x,k as A}from"./main-ClMj7z8a.js";import{E as B}from"./ErrorMessage-ysv-5oYb.js";import{M as F}from"./Modal-DaVDF2P-.js";import"./vendor-CBsUEP5T.js";import"./dnd-CO_aCEbe.js";import"./firebase-CLDmeQtM.js";import"./i18n-Cw5F73yC.js";const U=({isOpen:j,data:N,zIndex:_,overlayClassName:C})=>{const{t:r}=R(),{closeModal:l,openModal:b}=S(),g=!!j,e=N,c=!!(e!=null&&e.id),{workspaceId:o}=D(),[m,h]=t.useState(""),[n,v]=t.useState("#42A5F5"),[u,i]=t.useState(!1),[f,d]=t.useState(null),y=M.useRef(null);t.useEffect(()=>{g&&(h((e==null?void 0:e.name)||""),v((e==null?void 0:e.color)||p[Math.floor(Math.random()*p.length)].value),d(null),i(!1))},[g,e]),t.useEffect(()=>{var a;f&&((a=y.current)==null||a.focus())},[f]);const k=t.useCallback(async()=>{const a=m.trim();if(!a){d(r("validation.label_name_required"));return}i(!0),d(null);try{if(!o){d(r("validation.label_workspace_required")),i(!1);return}c&&(e!=null&&e.id)?await I(o,e.id,{name:a,color:n}):await O(o,a,n),l()}catch(L){d(r("validation.save_fail")+": "+(L.message||"Error")),i(!1)}},[m,n,c,e,l,r]),w=t.useCallback(async()=>{e!=null&&e.id&&b("confirmation",{title:r("delete"),message:r("modal.label_delete_confirm").replace("{name}",e.name),confirmLabel:r("delete"),variant:"danger",onConfirm:async()=>{i(!0);try{o&&(e!=null&&e.id)&&await T(o,e.id),l()}catch{d(r("validation.delete_fail")),i(!1)}}})},[e,l,b,o,r]),E=a=>{a.key==="Enter"&&!a.nativeEvent.isComposing&&(!u&&m.trim()&&k(),a.preventDefault())};return g?s.jsx(F,{isOpen:g,onClose:l,className:"max-w-sm",zIndex:_,overlayClassName:C,children:s.jsxs("div",{className:"flex flex-col gap-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex-shrink-0 border-2 border-gray-100 dark:border-gray-700 shadow-sm",style:{backgroundColor:n}}),s.jsx("div",{className:"flex-1",children:s.jsx(q,{ref:y,id:"label-name-input",name:"labelName",type:"text",label:r("modal.label_name"),value:m,onChange:a=>h(a.target.value),onKeyDown:E,placeholder:r(c?"modal.label_name_placeholder":"modal.label_create_placeholder"),className:"bg-transparent border-none text-lg font-bold p-0 focus:ring-0 focus:border-transparent px-0 py-0 rounded-none h-auto",containerClassName:"gap-0",autoFocus:!0,"aria-invalid":!!f,"aria-describedby":f?"label-error-msg":void 0})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-2",children:r("modal.theme_color")}),s.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(a=>s.jsx("button",{type:"button",onClick:()=>v(a.value),className:z("w-6 h-6 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",n===a.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-gray-800":""),style:{backgroundColor:a.value},"aria-label":r(`colors.${a.key}`),"aria-pressed":n===a.value},a.value))})]}),s.jsx(B,{message:f}),s.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"flex items-center gap-2",children:c&&s.jsx(x,{onClick:w,disabled:u,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20","aria-label":r("modal.delete_label"),title:r("modal.delete_label"),children:s.jsx(A,{size:20})})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(x,{onClick:l,disabled:u,variant:"ghost",children:r("modal.cancel")}),s.jsx(x,{onClick:k,disabled:u||!m.trim(),isLoading:u,variant:"primary",children:r(c?"modal.save":"modal.create")})]})]})]})}):null};export{U as LabelEditModal};
