import{d as t,c as L,j as r}from"./vendor-B1PbPNG1.js";import{u as R,j as S,q as T,U as y,r as I,t as M,v as P,w as D,C as F,o as z,B as p,p as U}from"./main-1-rMcdaW.js";import{E as q}from"./ErrorMessage-B7n1AM_t.js";import{M as A}from"./Modal-Dh8Gz3hP.js";import{I as B}from"./Input-DZ3fag93.js";import"./firebase-DyJWnMqn.js";import"./i18n-wsfI0CSL.js";const V=({isOpen:k,data:C,zIndex:E,overlayClassName:N})=>{const{t:s}=R(),{closeModal:o,openModal:x}=S(),{currentWorkspaceId:m}=T(),u=!!k,e=C,n=!!(e!=null&&e.id),[f,h]=t.useState(""),[i,b]=t.useState(y.DEFAULT_COLORS.PROJECT),[d,c]=t.useState(!1),[g,l]=t.useState(null),v=L.useRef(null);t.useEffect(()=>{u&&(h((e==null?void 0:e.name)||""),b((e==null?void 0:e.color)||y.DEFAULT_COLORS.PROJECT),l(null),c(!1))},[u,e]),t.useEffect(()=>{var a;g&&((a=v.current)==null||a.focus())},[g]);const j=t.useCallback(async()=>{const a=f.trim();if(!a){l(s("validation.project_name_required"));return}if(!m&&!n){l(s("validation.workspace_required"));return}c(!0),l(null);try{n&&(e!=null&&e.id)?await I(e.id,{name:a,color:i}):m&&await M(a,m,i),o()}catch(O){l(s("validation.save_fail")+": "+(O.message||"Error")),c(!1)}},[f,i,n,e,m,o,s]),_=t.useCallback(async()=>{e!=null&&e.id&&x("confirmation",{title:s("delete"),message:s("modal.project_delete_confirm").replace("{name}",e.name),confirmLabel:s("delete"),variant:"danger",onConfirm:async()=>{c(!0);try{await P(e.id),o()}catch{l(s("validation.delete_fail")),c(!1)}}})},[e,o,x,s]),w=a=>{a.key==="Enter"&&!a.nativeEvent.isComposing&&(!d&&f.trim()&&j(),a.preventDefault())};return u?r.jsx(A,{isOpen:u,onClose:o,size:"sm",zIndex:E,overlayClassName:N,children:r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 shrink-0",children:r.jsx(D,{size:20})}),r.jsx("div",{className:"flex-1",children:r.jsx(B,{ref:v,id:"project-name-input",name:"projectName",type:"text",label:s("modal.project_name"),value:f,onChange:a=>h(a.target.value),onKeyDown:w,placeholder:s("modal.project_name_placeholder"),className:"bg-transparent border-none text-lg font-bold p-0 focus:ring-0 focus:border-transparent px-0 py-0 rounded-none h-auto",containerClassName:"gap-0",autoFocus:!0,"aria-describedby":g?"project-error-msg":void 0,maxLength:10})})]}),r.jsxs("div",{role:"group","aria-labelledby":"theme-color-label",children:[r.jsx("span",{id:"theme-color-label",className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-2",children:s("modal.theme_color")}),r.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(a=>r.jsx("button",{type:"button",onClick:()=>b(a.value),className:z("w-6 h-6 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",i===a.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-gray-800":""),style:{backgroundColor:a.value},"aria-label":s(`colors.${a.key}`),"aria-pressed":i===a.value},a.value))})]}),r.jsx(q,{message:g,id:"project-error-msg"}),r.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700",children:[r.jsx("div",{className:"flex items-center gap-2",children:n&&r.jsx(p,{onClick:_,disabled:d,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20","aria-label":s("modal.delete_project"),title:s("modal.delete_project"),children:r.jsx(U,{size:20})})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(p,{onClick:o,disabled:d,variant:"ghost",children:s("modal.cancel")}),r.jsx(p,{onClick:j,disabled:d,isLoading:d,variant:"primary",children:s(n?"modal.save":"modal.create")})]})]})]})}):null};export{V as ProjectEditModal};
