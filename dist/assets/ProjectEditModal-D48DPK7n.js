import{r as t,R as S,j as r}from"./react-vendor-D2I7O6xs.js";import{u as R,a as I,l as L,C as y,m as P,n as T,o as z,q as D,I as O,j as q,B as p,k as B}from"./main-ClMj7z8a.js";import{E as F}from"./ErrorMessage-ysv-5oYb.js";import{M as K}from"./Modal-DaVDF2P-.js";import"./vendor-CBsUEP5T.js";import"./dnd-CO_aCEbe.js";import"./firebase-CLDmeQtM.js";import"./i18n-Cw5F73yC.js";const V=({isOpen:k,data:C,zIndex:N,overlayClassName:E})=>{const{t:s}=R(),{closeModal:o,openModal:x}=I(),{currentWorkspaceId:m}=L(),u=!!k,e=C,l=!!(e!=null&&e.id),[f,v]=t.useState(""),[i,h]=t.useState("#7E57C2"),[d,c]=t.useState(!1),[g,n]=t.useState(null),b=S.useRef(null);t.useEffect(()=>{u&&(v((e==null?void 0:e.name)||""),h((e==null?void 0:e.color)||y[3].value),n(null),c(!1))},[u,e]),t.useEffect(()=>{var a;g&&((a=b.current)==null||a.focus())},[g]);const j=t.useCallback(async()=>{const a=f.trim();if(!a){n(s("validation.project_name_required"));return}if(!m&&!l){n(s("validation.workspace_required"));return}c(!0),n(null);try{l&&(e!=null&&e.id)?await P(e.id,{name:a,color:i}):m&&await T(a,m,i),o()}catch(M){n(s("validation.save_fail")+": "+(M.message||"Error")),c(!1)}},[f,i,l,e,m,o,s]),_=t.useCallback(async()=>{e!=null&&e.id&&x("confirmation",{title:s("delete"),message:s("modal.project_delete_confirm").replace("{name}",e.name),confirmLabel:s("delete"),variant:"danger",onConfirm:async()=>{c(!0);try{await z(e.id),o()}catch{n(s("validation.delete_fail")),c(!1)}}})},[e,o,x,s]),w=a=>{a.key==="Enter"&&!a.nativeEvent.isComposing&&(!d&&f.trim()&&j(),a.preventDefault())};return u?r.jsx(K,{isOpen:u,onClose:o,size:"sm",zIndex:N,overlayClassName:E,children:r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 shrink-0",children:r.jsx(D,{size:20})}),r.jsx("div",{className:"flex-1",children:r.jsx(O,{ref:b,id:"project-name-input",name:"projectName",type:"text",label:s("modal.project_name"),value:f,onChange:a=>v(a.target.value),onKeyDown:w,placeholder:s("modal.project_name_placeholder"),className:"bg-transparent border-none text-lg font-bold p-0 focus:ring-0 focus:border-transparent px-0 py-0 rounded-none h-auto",containerClassName:"gap-0",autoFocus:!0,"aria-describedby":g?"project-error-msg":void 0})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-2",children:s("modal.theme_color")}),r.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(a=>r.jsx("button",{type:"button",onClick:()=>h(a.value),className:q("w-6 h-6 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",i===a.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-gray-800":""),style:{backgroundColor:a.value},"aria-label":s(`colors.${a.key}`),"aria-pressed":i===a.value},a.value))})]}),r.jsx(F,{message:g,id:"project-error-msg"}),r.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700",children:[r.jsx("div",{className:"flex items-center gap-2",children:l&&r.jsx(p,{onClick:_,disabled:d,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20","aria-label":s("modal.delete_project"),title:s("modal.delete_project"),children:r.jsx(B,{size:20})})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(p,{onClick:o,disabled:d,variant:"ghost",children:s("modal.cancel")}),r.jsx(p,{onClick:j,disabled:d,isLoading:d,variant:"primary",children:s(l?"modal.save":"modal.create")})]})]})]})}):null};export{V as ProjectEditModal};
