import{r as t,R,j as r}from"./react-vendor-D2I7O6xs.js";import{u as L,a as S,h as T,U as y,i as I,j as M,k as P,l as D,I as F,C as z,f as U,B as p,g as A}from"./main-Bx0l58pa.js";import{E as q}from"./ErrorMessage-ysv-5oYb.js";import{M as B}from"./Modal-DLEcublt.js";import"./vendor-CBsUEP5T.js";import"./dnd-BYudv-0e.js";import"./firebase-Dk4oNdYC.js";import"./i18n-CkMKOdEg.js";const X=({isOpen:k,data:C,zIndex:E,overlayClassName:N})=>{const{t:s}=L(),{closeModal:o,openModal:x}=S(),{currentWorkspaceId:m}=T(),u=!!k,e=C,l=!!(e!=null&&e.id),[f,h]=t.useState(""),[i,v]=t.useState(y.DEFAULT_COLORS.PROJECT),[d,c]=t.useState(!1),[g,n]=t.useState(null),b=R.useRef(null);t.useEffect(()=>{u&&(h((e==null?void 0:e.name)||""),v((e==null?void 0:e.color)||y.DEFAULT_COLORS.PROJECT),n(null),c(!1))},[u,e]),t.useEffect(()=>{var a;g&&((a=b.current)==null||a.focus())},[g]);const j=t.useCallback(async()=>{const a=f.trim();if(!a){n(s("validation.project_name_required"));return}if(!m&&!l){n(s("validation.workspace_required"));return}c(!0),n(null);try{l&&(e!=null&&e.id)?await I(e.id,{name:a,color:i}):m&&await M(a,m,i),o()}catch(O){n(s("validation.save_fail")+": "+(O.message||"Error")),c(!1)}},[f,i,l,e,m,o,s]),_=t.useCallback(async()=>{e!=null&&e.id&&x("confirmation",{title:s("delete"),message:s("modal.project_delete_confirm").replace("{name}",e.name),confirmLabel:s("delete"),variant:"danger",onConfirm:async()=>{c(!0);try{await P(e.id),o()}catch{n(s("validation.delete_fail")),c(!1)}}})},[e,o,x,s]),w=a=>{a.key==="Enter"&&!a.nativeEvent.isComposing&&(!d&&f.trim()&&j(),a.preventDefault())};return u?r.jsx(B,{isOpen:u,onClose:o,size:"sm",zIndex:E,overlayClassName:N,children:r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 text-gray-500 shrink-0",children:r.jsx(D,{size:20})}),r.jsx("div",{className:"flex-1",children:r.jsx(F,{ref:b,id:"project-name-input",name:"projectName",type:"text",label:s("modal.project_name"),value:f,onChange:a=>h(a.target.value),onKeyDown:w,placeholder:s("modal.project_name_placeholder"),className:"bg-transparent border-none text-lg font-bold p-0 focus:ring-0 focus:border-transparent px-0 py-0 rounded-none h-auto",containerClassName:"gap-0",autoFocus:!0,"aria-describedby":g?"project-error-msg":void 0})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-2",children:s("modal.theme_color")}),r.jsx("div",{className:"flex flex-wrap gap-2",children:z.map(a=>r.jsx("button",{type:"button",onClick:()=>v(a.value),className:U("w-6 h-6 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800",i===a.value?"ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-gray-800":""),style:{backgroundColor:a.value},"aria-label":s(`colors.${a.key}`),"aria-pressed":i===a.value},a.value))})]}),r.jsx(q,{message:g,id:"project-error-msg"}),r.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700",children:[r.jsx("div",{className:"flex items-center gap-2",children:l&&r.jsx(p,{onClick:_,disabled:d,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20","aria-label":s("modal.delete_project"),title:s("modal.delete_project"),children:r.jsx(A,{size:20})})}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(p,{onClick:o,disabled:d,variant:"ghost",children:s("modal.cancel")}),r.jsx(p,{onClick:j,disabled:d,isLoading:d,variant:"primary",children:s(l?"modal.save":"modal.create")})]})]})]})}):null};export{X as ProjectEditModal};
